# -*- coding: utf-8 -*-
"""
Created on Thu Apr 10 23:26:35 2025

@author: user
"""

from fastapi import Query

q: str = Query(default=None, min_length=3, max_length=50)

# å¥½å•é¡Œï¼Query(min_length=3, max_length=50) æ˜¯ FastAPI æä¾›çš„ä¸€å€‹å‡½å¼ï¼Œç”¨ä¾†è¨­å®šæŸ¥è©¢åƒæ•¸ï¼ˆquery parametersï¼‰çš„é©—è­‰æ¢ä»¶ï¼Œä¹Ÿå¯ä»¥æä¾›ä¸€äº›é¡å¤–çš„ metadataï¼Œä¾‹å¦‚é è¨­å€¼ã€æè¿°ã€ç¯„ä¾‹ç­‰ã€‚

# =============================================================================
# é€™æ®µæ„æ€æ˜¯ï¼šq æ˜¯ä¸€å€‹æŸ¥è©¢åƒæ•¸ï¼ˆä¾‹å¦‚ /items?q=hello ä¸­çš„ qï¼‰ï¼Œå®ƒï¼š
# 
# æ˜¯ str é¡å‹
# 
# æœ€å°é•·åº¦ç‚º 3
# 
# æœ€å¤§é•·åº¦ç‚º 50
# 
# é è¨­å€¼æ˜¯ None
# 
# FastAPI æœƒè‡ªå‹•æ ¹æ“šé€™äº›æ¢ä»¶é€²è¡Œé©—è­‰ã€‚
# =============================================================================

from fastapi import FastAPI, Query
from typing import Annotated

app = FastAPI()

@app.get("/items/")
def read_items(q: Annotated[str, Query(min_length=3, max_length=10)]):
    return {"q": q}

# =============================================================================
# é€™æœƒç”¢ç”Ÿä¸€å€‹ /items?q=xxx çš„ APIï¼š
# 
# å¦‚æœå°‘æ–¼ 3 å€‹å­—å…ƒï¼šæœƒå›å‚³ 422 éŒ¯èª¤ï¼ˆUnprocessable Entityï¼‰
# 
# è¶…é 10 å€‹å­—å…ƒï¼šåŒæ¨£å ±éŒ¯
# 
# ä¸¦ä¸”é€™äº›é©—è­‰æ¢ä»¶æœƒé¡¯ç¤ºåœ¨ /docs Swagger UI ä¸Š
# =============================================================================


# metadata æ˜¯ç”šéº¼?

# =============================================================================
# ğŸ” åœ¨ Python ä¸­çš„æ‡‰ç”¨
# åœ¨ Python ä¸­ï¼Œmetadata å¸¸ç”¨æ–¼è£é£¾å™¨ã€å‹åˆ¥è¨»è§£ã€åº«çš„é…ç½®é¸é …ç­‰ã€‚metadata æœ¬èº«ä¸æœƒæ”¹è®Šå‡½æ•¸æˆ–è®Šæ•¸çš„è¡Œç‚ºï¼Œä½†å¯ä»¥å¹«åŠ©ä¸€äº›å·¥å…·ï¼ˆä¾‹å¦‚ FastAPIã€Pydantic æˆ–éœæ…‹åˆ†æå·¥å…·ï¼‰é€²è¡Œé€²ä¸€æ­¥çš„è™•ç†ã€‚
# 
# ğŸ’¡ ä¾‹å­ 1: FastAPI ä¸­çš„ Query å’Œ metadata
# ç•¶ä½ åœ¨ FastAPI ä¸­ä½¿ç”¨ Query æˆ– Body ç­‰ä¾†æè¿°åƒæ•¸æ™‚ï¼Œä½ å°±æœƒä½¿ç”¨ metadataã€‚æ¯”å¦‚ï¼š
# 
# =============================================================================

from fastapi import FastAPI, Query

app = FastAPI()

@app.get("/items/")
def read_items(q: str = Query(..., min_length=3, max_length=50, description="Search query")):
    return {"q": q}
# =============================================================================
# åœ¨é€™è£¡ï¼š
# 
# min_length=3 å’Œ max_length=50 æ˜¯é©—è­‰çš„ metadataï¼Œé™åˆ¶äº† q åƒæ•¸çš„æœ€å°å’Œæœ€å¤§é•·åº¦ã€‚
# 
# description="Search query" æ˜¯æè¿°æ–‡å­—ï¼Œå®ƒåœ¨ FastAPI ç”Ÿæˆçš„ API æ–‡æª”ä¸­æœƒé¡¯ç¤ºï¼Œå¹«åŠ©ç”¨æˆ¶ç†è§£é€™å€‹åƒæ•¸çš„ç”¨é€”ã€‚
# 
# é€™äº› metadata æœƒè¢« FastAPI ä½¿ç”¨ï¼Œç”¨ä¾†ç”Ÿæˆ API æ–‡æª”ï¼ˆSwagger UIï¼‰æˆ–é€²è¡Œåƒæ•¸é©—è­‰ã€‚
# 
# 
# ğŸš€ ç¸½çµ
# metadata æ˜¯ç”¨ä¾†æè¿°æ•¸æ“šçš„é¡å¤–è³‡è¨Šï¼Œé€šå¸¸ç”¨æ–¼è¼”åŠ©è™•ç†ã€æ–‡æª”ç”Ÿæˆæˆ–é©—è­‰ï¼Œä½†ä¸æœƒç›´æ¥å½±éŸ¿æ•¸æ“šæœ¬èº«çš„é‚è¼¯ã€‚
# 
# åœ¨ FastAPI ä¸­ï¼Œmetadata ä¸»è¦ç”¨æ–¼æ§åˆ¶å¦‚ä½•è™•ç†è«‹æ±‚åƒæ•¸ï¼ˆä¾‹å¦‚æŸ¥è©¢åƒæ•¸ã€è·¯ç”±åƒæ•¸ç­‰ï¼‰ï¼Œä¸¦ä¸”å®ƒæœƒå½±éŸ¿æ–‡æª”ã€é©—è­‰ç­‰ã€‚
# =============================================================================

